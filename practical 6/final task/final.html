<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Smart Job Application Analyzer</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#94a3b8;--accent:#60a5fa;--glass: rgba(255,255,255,0.03)}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial}
    body{background:linear-gradient(180deg,#071129 0%,#071833 100%);color:#e6eef8;display:flex;align-items:center;justify-content:center;padding:28px}
    .wrapper{width:100%;max-width:1100px}
    header{display:flex;align-items:center;gap:12px;margin-bottom:18px}
    header h1{margin:0;font-size:20px}
    .grid{display:grid;grid-template-columns:1fr 440px;gap:18px}
    .card{background:var(--card);border-radius:12px;padding:16px;box-shadow:0 6px 18px rgba(2,6,23,0.6)}
    textarea{width:100%;height:360px;background:var(--glass);border:1px solid rgba(255,255,255,0.04);color:inherit;padding:12px;border-radius:8px;resize:vertical;font-family:monospace}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    button{background:linear-gradient(90deg,var(--accent),#3b82f6);border:none;padding:8px 12px;border-radius:8px;color:#022;cursor:pointer;font-weight:600}
    button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    .samples{display:flex;gap:6px;flex-wrap:wrap}
    pre{background:#051226;padding:12px;border-radius:8px;overflow:auto;height:360px;font-size:13px}
    .meta{display:flex;align-items:center;gap:10px;justify-content:space-between}
    .footer{margin-top:10px;color:var(--muted);font-size:13px}
    .badge{background:rgba(255,255,255,0.04);padding:6px 8px;border-radius:999px;font-size:12px}
    .copy{display:inline-block;margin-left:8px;padding:6px 8px;background:transparent;border:1px solid rgba(255,255,255,0.04);border-radius:8px;cursor:pointer}
    @media (max-width:980px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrapper">
    <header>
      <h1>Smart Job Application Analyzer</h1>
      <div class="badge">JS + Regex â€¢ No libraries</div>
    </header>

    <div class="grid">
      <div class="card">
        <label style="font-weight:700">Paste raw application text:</label>
        <textarea id="input" spellcheck="false"></textarea>

        <div class="controls">
          <div class="samples">
            <button id="load1" class="ghost">Load sample 1</button>
            <button id="load2" class="ghost">Load sample 2</button>
            <button id="load3" class="ghost">Load sample 3</button>
            <button id="load4" class="ghost">Load sample 4</button>
          </div>
          <div style="flex:1"></div>
          <button id="parse">Parse</button>
          <button id="clear" class="ghost">Clear</button>
        </div>

        <div class="footer">Tip: the parser is resilient to messy spacing, extra symbols and mixed case.</div>
      </div>

      <div class="card">
        <div class="meta">
          <div style="font-weight:700">Parsed Output (JSON)</div>
          <div>
            <button id="copy" class="copy">Copy</button>
            <button id="download" class="copy">Download</button>
          </div>
        </div>
        <pre id="output">{ }

</pre>
      </div>
    </div>
  </div>

  <script>
    // ---------------- Sample inputs ----------------
    const samples = {
      application1: `\nApplicant: maRy annE thomPSON\nPrimary Email: mary.thompson@GMAIL.com\nAlternate Email: thompson.mary@work.co.in\nContact: +91-9876543210\nSkills: Java , HTML/CSS , ReactJS , Node.js , SQL\nCover: I am applying for the role of Full Stack Developer!!\nExpected Salary: $ 75,000 per annum\nTags: #FullStack #Developer #Java #ReactJS #2025Goals\n`,

      application2: `\nApplicant: DaNIEL RoBERTsOn\nPrimary Email: daniel.rob@company.com\nAlternate Email: drobertson@mail.org dan.rob.personal@GMAIL.COM\nContact: +91-1234567890\nSkills: Python, Django , Machine Learning,Data Science, AI\nExpected Salary: $120,500 per year\nNote: Please reply only to dan.rob.personal@gmail.com\nTags: #AI #DataScience #Python #2025Career\n`,

      application3: `\nApplicant: soPhia WILSON\nPrimary Email: sophia.wilson@MAIL.com\nContact: +44-7896541230\nSkills: C, C++ , Java , JavaScript , React , Angular\nCover: Looking forward to joining your team...\nExpected Salary: 95000 INR\nExtra Emails: s.wilson@backup.co.uk sophia_alt@work.com\nTags: #Developer #Engineer #Cplusplus #React #Angular #NewJob\n`,

      application4: `\nRandom Line: Ignore this text completely\nApplicant: keVin O'BRIEN\nPrimary Email: kevin.obrien@MAIL.COM\nAlternate Email: obrien.kevin@dev.org\nContact: +91-7891234567\nSkills: GoLang , Rust, JavaScript , TypeScript, Node.js\nCover: I am extremely interested in this--role!!!\nExpected Salary: USD 88,750\nTags: #GoLang #Rust #JavaScript #TypeScript #Node #CoderLife\n`
    };

    // ---------------- Utility functions ----------------
    function titleCaseWord(word){
      // preserve apostrophes inside names like O'BRIEN
      if(!word) return word;
      // lowercase everything first, then uppercase first letter and letter after apostrophe
      let w = word.toLowerCase();
      w = w.replace(/(^|')([a-z])/g, (m,p,ch) => p + ch.toUpperCase());
      return w;
    }

    function formatName(rawText){
      const m = rawText.match(/Applicant\s*:\s*([^\n]+)/i);
      if(!m) return "";
      const name = m[1].trim().replace(/\s+/g,' ');
      return name.split(/\s+/).map(titleCaseWord).join(' ');
    }

    function extractEmails(rawText){
      // RFC-ish simple email regex but good enough for this task
      const emails = (rawText.match(/[a-zA-Z0-9._%+\-]+@[a-zA-Z0-9.\-]+\.[a-zA-Z]{2,}/g) || [])
        .map(e => e.toLowerCase());

      // prefer explicit Primary Email if present
      const primaryLabel = rawText.match(/Primary\s+Email\s*:\s*([a-zA-Z0-9._%+\-]+@[a-zA-Z0-9.\-]+\.[a-zA-Z]{2,})/i);
      let primary = primaryLabel ? primaryLabel[1].toLowerCase() : (emails[0] || "");
      // ensure primary is first in the list
      const others = emails.filter(e => e !== primary);
      return { primaryEmail: primary, altEmails: others };
    }

    function extractPhone(rawText){
      // look for +<country>-<number> where number is at least 7 and usually 10
      const m = rawText.match(/\+(\d{1,3})-(\d{7,15})/);
      if(!m) return "Invalid phone number";
      const number = m[2];
      // After dash, first digit must be 6-9 (as per requirement)
      if(!/^[6-9]/.test(number)) return "Invalid phone number";
      return `+${m[1]}-${number}`;
    }

    function extractSkills(rawText){
      const m = rawText.match(/Skills\s*:\s*([^\n]+)/i);
      if(!m) return [];
      // split by comma or by comma-less separators (some messy inputs use no space)
      return m[1].split(',')
        .map(s => s.trim())
        .filter(s => s.length>0);
    }

    function extractHashtags(rawText){
      return rawText.match(/#[A-Za-z0-9_]+/g) || [];
    }

    function extractSalary(rawText){
      // Look for common labels then pull digits
      const m = rawText.match(/(Expected\s+Salary|Salary)\s*:\s*([^\n]+)/i) || rawText.match(/(USD|INR|\$)\s*([0-9,]+)/i);
      let str = '';
      if(m){ str = m[2] || m[1] || '' }
      else {
        // fallback: find any number with commas that looks like a salary
        const f = rawText.match(/\b[0-9]{2,3}(?:,[0-9]{3})+\b|\b[0-9]{5,6}\b/g);
        str = f ? f[0] : '';
      }
      // remove non-digits
      const digits = (str || '').replace(/[^0-9]/g,'');
      return digits ? parseInt(digits,10) : 0;
    }

    function wordCount(rawText){
      // Count tokens that contain letters/numbers/hashtags
      const toks = rawText.trim().split(/\s+/).filter(t => /[A-Za-z0-9#@']/.test(t));
      return toks.length;
    }

    function vowelCount(rawText){
      const v = rawText.match(/[aeiou]/gi);
      return v ? v.length : 0;
    }

    function parseApplication(text){
      return {
        applicant: formatName(text),
        ...extractEmails(text),
        phone: extractPhone(text),
        skills: extractSkills(text),
        hashtags: extractHashtags(text),
        salary: extractSalary(text),
        wordCount: wordCount(text),
        vowelCount: vowelCount(text)
      };
    }

    // ------------- DOM wiring -------------
    const input = document.getElementById('input');
    const output = document.getElementById('output');
    document.getElementById('load1').addEventListener('click', ()=> input.value = samples.application1);
    document.getElementById('load2').addEventListener('click', ()=> input.value = samples.application2);
    document.getElementById('load3').addEventListener('click', ()=> input.value = samples.application3);
    document.getElementById('load4').addEventListener('click', ()=> input.value = samples.application4);
    document.getElementById('clear').addEventListener('click', ()=> { input.value = ''; output.textContent = '{ }'; });

    document.getElementById('parse').addEventListener('click', ()=>{
      const text = input.value || '';
      if(!text.trim()){ output.textContent = '{ /* paste application text here */ }'; return; }
      const result = parseApplication(text);
      output.textContent = JSON.stringify(result, null, 2);
    });

    document.getElementById('copy').addEventListener('click', async ()=>{
      try{ await navigator.clipboard.writeText(output.textContent); alert('Copied to clipboard'); }catch(e){ alert('Copy failed'); }
    });

    document.getElementById('download').addEventListener('click', ()=>{
      const blob = new Blob([output.textContent], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'parsed-application.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    // autoload sample 1
    input.value = samples.application1;
    document.getElementById('parse').click();
  </script>
</body>
</html>
